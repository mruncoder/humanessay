<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Humanize.ai</title>

<!-- DOCX library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.2.2/docx.umd.min.js"></script>

<style>
body {
  background:#0f172a;
  font-family:system-ui;
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  margin:0;
}

.app {
  background:#020617;
  width:480px;
  padding:20px;
  border-radius:12px;
  box-shadow:0 0 30px rgba(0,0,0,0.6);
}

h1 {
  text-align:center;
  margin-bottom:4px;
}

.subtitle {
  text-align:center;
  font-size:14px;
  opacity:0.7;
}

textarea {
  width:100%;
  height:130px;
  margin-top:15px;
  padding:10px;
  border-radius:8px;
  border:none;
  resize:none;
  font-size:14px;
}

.controls {
  display:flex;
  gap:10px;
  margin-top:10px;
}

select, button {
  flex:1;
  padding:10px;
  border-radius:8px;
  border:none;
  font-size:14px;
}

button {
  background:#22c55e;
  cursor:pointer;
}

button:hover {
  background:#16a34a;
}

.output {
  margin-top:15px;
  background:#020617;
  padding:10px;
  border-radius:8px;
  min-height:100px;
  font-size:14px;
  white-space:pre-wrap;
}

.status {
  text-align:center;
  font-size:13px;
  margin-top:8px;
  opacity:0.8;
}

.footer {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-top:10px;
  font-size:12px;
  opacity:0.8;
}

.actions span {
  cursor:pointer;
  margin-left:8px;
  color:#22c55e;
}
</style>
</head>

<body>
<div class="app">
  <h1>Humanize.ai</h1>
  <div class="subtitle">Make AI writing sound human</div>

  <textarea id="input" placeholder="Paste AI-generated text here..."></textarea>

  <div class="controls">
    <select id="tone">
      <option value="neutral">Neutral</option>
      <option value="casual">Casual</option>
      <option value="formal">Formal</option>
    </select>
    <button onclick="humanize()">Humanize</button>
  </div>

  <div class="status" id="status"></div>

  <div class="output" id="output"></div>

  <div class="footer">
    <div id="counter">0 words</div>
    <div class="actions">
      <span onclick="copyText()">Copy</span>
      <span onclick="downloadTXT()">TXT</span>
      <span onclick="downloadDOCX()">DOCX</span>
    </div>
  </div>
</div>

<script>
function humanize() {
  let text = document.getElementById("input").value.trim();
  const tone = document.getElementById("tone").value;
  const output = document.getElementById("output");
  const status = document.getElementById("status");

  if (text.length < 15) {
    status.innerText = "❌ Text too short to humanize.";
    output.innerText = "";
    return;
  }

  status.innerText = "Humanizing text...";
  output.innerText = "";

  setTimeout(() => {

    const replacements = {
      "In conclusion": ["To sum it up", "Overall"],
      "Furthermore": ["Also", "Plus"],
      "Moreover": ["On top of that", "Another thing is"],
      "utilize": ["use"],
      "individuals": ["people"],
      "significant": ["important", "big"],
      "therefore": ["so"],
      "however": ["but"]
    };

    for (let key in replacements) {
      const pick = replacements[key][Math.floor(Math.random() * replacements[key].length)];
      text = text.replace(new RegExp(key, "gi"), pick);
    }

    if (tone === "casual") {
      text = "Honestly, " + text;
    }

    if (tone === "formal") {
      text = text.replace(/Honestly,/gi, "");
      text = text.replace(/\bbut\b/gi, "however");
    }

    output.innerText = text;
    status.innerText = "✅ Humanization complete.";
    updateCounter(text);

  }, 900);
}

function updateCounter(text) {
  const words = text.trim().split(/\s+/).length;
  document.getElementById("counter").innerText = words + " words";
}

function copyText() {
  const text = document.getElementById("output").innerText;
  if (!text) return;
  navigator.clipboard.writeText(text);
}

function downloadTXT() {
  const text = document.getElementById("output").innerText;
  if (!text) return;

  const blob = new Blob([text], { type: "text/plain" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "humanized-text.txt";
  link.click();
}

function downloadDOCX() {
  const text = document.getElementById("output").innerText;
  if (!text) return;

  const { Document, Packer, Paragraph } = window.docx;

  const doc = new Document({
    sections: [{
      children: text.split("\n").map(line =>
        new Paragraph({ text: line })
      )
    }]
  });

  Packer.toBlob(doc).then(blob => {
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "humanized-text.docx";
    link.click();
  });
}
</script>
</body>
</html>